#!/bin/bash

T=$(mktemp -d)
trap "rm -rf $T" EXIT

cat >$T/debian_packages <<...
curl
fzf
git
git-lfs
locales
python3-pip
ripgrep
silversearcher-ag
sudo
tmux
vim
xz-utils
...

cat >$T/python_packages <<...
black
isort
python-language-server
...

cat >$T/locale.gen <<...
en_US.UTF-8 UTF-8
en_GB.UTF-8 UTF-8
...

cat >$T/Dockerfile <<...
FROM ubuntu:jammy

COPY debian_packages .
RUN apt update
RUN env DEBIAN_FRONTEND=noninteractive xargs apt install --yes <debian_packages

COPY python_packages .
RUN pip3 install -r python_packages

COPY locale.gen /etc/locale.gen
RUN locale-gen

RUN adduser --gecos '' --disabled-password --uid $UID $USER
RUN echo '$USER ALL=(ALL:ALL) NOPASSWD:ALL' >/etc/sudoers.d/$USER

CMD cd "$PWD" ; sudo -u $USER -- bash -i
...

docker build --tag lets-get-creative $T
docker run -ti \
  --mount type=bind,source=$HOME,target=/home/$USER \
  lets-get-creative
